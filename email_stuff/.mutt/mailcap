# ~/dotfiles/email_stuff/.mutt/mailcap
#
# this uses the view_attachment script found in ~/dotfiles/email_stuff/.mutt/view_attachment.sh
#
text/calendar; mutt-ics; copiousoutput
application/ics; mutt-ics; copiousoutput 
video/*; mplayer '%s'; test=test -n "$DISPLAY"
# MS Excel
# this will use the default xls spreadsheet handler from open
application/x-msexcel; ~/dotfiles/email_stuff/.mutt/view_attachment.sh %s doc
application/ms-exc; ~/dotfiles/email_stuff/.mutt/view_attachment.sh %s doc
application/excel; ~/dotfiles/email_stuff/.mutt/view_attachment.sh %s doc
application/msexcel; ~/dotfiles/email_stuff/.mutt/view_attachment.sh %s doc
application/vnd.ms-exc; ~/dotfiles/email_stuff/.mutt/view_attachment.sh %s doc
application/vnd.ms-excel; ~/dotfiles/email_stuff/.mutt/view_attachment.sh %s doc

# MS Word
# use textedit to open .doc files as it's more light-weight
application/msword; ~/dotfiles/email_stuff/.mutt/view_attachment.sh %s doc

# docx
application/vnd.openxmlformats-officedocument.wordprocessingml.document; ~/dotfiles/email_stuff/.mutt/view_attachment.sh %s doc
# xlsx
application/vnd.openxmlformats-officedocument.spreadsheetml.sheet; ~/dotfiles/email_stuff/.mutt/view_attachment.sh %s doc

# Images
image/jpeg; ~/dotfiles/email_stuff/.mutt/view_attachment.sh %s img
image/pjpeg; ~/dotfiles/email_stuff/.mutt/view_attachment.sh %s img
image/png; ~/dotfiles/email_stuff/.mutt/view_attachment.sh %s img
image/gif; ~/dotfiles/email_stuff/.mutt/view_attachment.sh %s img

# PDF
application/pdf; ~/dotfiles/email_stuff/.mutt/view_attachment.sh %s pdf

# HTML
# text/html; ~/dotfiles/email_stuff/.mutt/view_attachment.sh %s html

# Unidentified.
application/octet-stream; ~/dotfiles/email_stuff/.mutt/view_attachment.sh %s "-" # # text/html; w3m -I %{charset} -T text/html; copiousoutput;
# text/html; pandoc -f html -t markdown; copiousoutput; description=HTML Text; test=type pandoc >/dev/null
# text/html; lynx -stdin -dump -force_html -width 70; copiousoutput; description=HTML Text; test=type lynx >/dev/null
text/html; w3m -dump -T text/html -cols 70; copiousoutput; description=HTML Text; test=type w3m >/dev/null
text/html; html2text -width 70; copiousoutput; description=HTML Text; test=type html2text >/dev/null
text/html; elinks -dump %s -eval 'set document.codepage.assume = "%{charset}"' -eval 'set document.dump.width = 100'; nametemplate=%s.html; copiousoutput
text/html; mv %s %s.html && qutebrowser %s.html > /dev/null; needsterminal;
# # image/*; ~/.config/dotfiles/email_stuff/.mutt/muttimage.sh %s ; copiousoutput

# application/pdf; zathura %s &>/dev/null
# # image/JPG; feh -F -Z %s &>/dev/null
# # image/jpeg; feh -F -Z %s &>/dev/null
# # image/gif; feh -F -Z %s &>/dev/null
# # image/png; feh -F -Z %s &>/dev/null
# application/vnd.oasis.opendocument.text; libreoffice %s &>/dev/null
# application/vnd.ms-excel; libreoffice %s &>/dev/null
# application/vnd.oasis.opendocument.spreadsheet; libreoffice %s &>/dev/null
# application/msword; libreoffice %s &>/dev/null

# #
# application/vnd.ms-powerpoint;dotfiles/email_stuff/.mutt_bgrun qvpview %s; test=RunningX
# application/vnd.ms-powerpoint;	ppt2text %s; copiousoutput
# application/x-mspowerpoint;dotfiles/email_stuff/.mutt_bgrun qvpview %s; test=RunningX
# application/x-mspowerpoint;	ppt2text %s; copiousoutput
# application/ppt;	dotfiles/email_stuff/.mutt_bgrun qvpview %s; test=RunningX
# application/ppt;		ppt2text %s; copiousoutput

# application/postscript;	dotfiles/email_stuff/.mutt_bgrun ghostview %s; test=RunningX

# application/rtf;	dotfiles/email_stuff/.mutt_bgrun qvpview %s; test=RunningX
# application/rtf;		rtf2text %s; copiousoutput

# application/ms-tnef;		tnef -w %s

# # image/*;		dotfiles/email_stuff/.mutt_bgrun xv %s; test=RunningX
# text/m;			less %s
# image/*; ~/dotfiles/email_stuff/.mutt/muttimage.sh %s ; copiousoutput