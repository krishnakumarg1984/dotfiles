bind attach <Esc>e noop # Normally <resend-message>.
bind editor <space> noop     # So line-editor can accept folders with spaces in their names.
bind generic * noop          # Normally <last-entry>.
bind generic < noop          # Normally <previous-line>.
bind generic = noop          # Normally <first-entry>.
bind generic > noop          # Normally <next-line>.
bind generic Z noop
bind generic [ noop          # Normally <half-up>.
bind generic \; noop         # Normally <tag-prefix>.
bind generic ] noop          # Normally <half-down>.
bind generic z noop          # Normally <next-page>.
bind generic,alias,attach,browser,editor,index,compose,pager,pgp,postpone ':' noop
bind generic,pager       t         noop
bind index % noop           # Normally <toggle-write>.
bind index . noop
bind index <Esc><Tab> noop  # Normally <previous-new-then-unread>.
bind index <Esc>V noop      # Normally <collapse-all>.
bind index <Esc>t noop      # Normally <tag-thread>, which we have bound to t.
bind index <Esc>v noop      # Normally <collapse-thread>, which we have bound to <tab>.
bind index,pager V  noop       # Unbinds V from version
bind index,pager c noop
bind index,pager s noop
bind index,pager w noop        # Normally <set-flag>.
bind pager <BackSpace> noop    # Normally <previous-line>.
bind pager Q noop              # Normally <quit>.
bind pager T noop              # Normally <toggle-quoted>.
bind pager ^ noop              # Normally <top>, which we have bound to gg.
bind pager g noop
bind pager i noop              # Normally <exit>, but that is also bound to q.
bind pager,index d  noop
# bind attach,index,pager p noop          # Normally <print-entry> or <print-message>.
bind attach,index,pager <Esc>P noop     # Normally <check-traditional-pgp>.
bind attach,index,pager \CE noop        # Normally <edit-type>.
bind attach,index,pager \CK noop        # Normally <extract-keys>.
bind attach,index,pager b previous-page # Normally <bounce-message>, but we use \b for that.
bind attach,index,pager \b bounce-message 
bind attach,compose,index,pager | noop  # Normally <pipe-entry> or <pipe-message>.;w
bind attach,browser,index          g noop
bind attach v noop # Normally <collapse-parts>, we use <tab> instead.
bind attach f noop # Normally <forward-message>.
bind attach i noop # Normally <ispell>.
bind attach m noop # Normally <view-mailcap>, which we have bound to <return>.
bind attach r noop # Normally <reply>.
attachments +A message/.* multipart/.*
attachments +I message/.* multipart/.*
alternates kg314@imperial.ac.uk|k.gopalakrishnan14@imperial.ac.uk|krishnakumar@imperial.ac.uk
alternative_order text/calendar text/plain text/enriched text/html text/*
attachments -A message/external-body
attachments -I message/external-body
auto_view text/calendar application/ics
auto_view application/octet-stream
auto_view text/x-vcard text/html application/octet-stream
auto_view text/html application/pdf image/*
auto_view application/ms-rtf application/rtf application/ms-tnef
auto_view application/msword application/vnd.ms-excel application/ms-excel
auto_view application/msexcel application/pdf application/postscript
auto_view text/x-lyx
auto_view application/zip
auto_view application/x-gzip
auto_view application/x-gunzip 
auto_view application/pgp-signature
auto_view application/pgp
auto_view application/octet-stream 
auto_view application/x-zip-compressed
auto_view application/vnd.ms-powerpoint
auto_view application/vnd.ms-excel
auto_view application/x-arj-compressed
auto_view application/x-tar-gz
auto_view application/ms-tnef
auto_view application/x-perl
auto_view application/x-sh
auto_view application/x-tcl
auto_view application/x-delphi-source
auto_view application/emacs-lisp
auto_view application/msword
auto_view application/pdf
auto_view text/x-patch
auto_view text/html
auto_view text/HTML
auto_view text/x-vcard
auto_view text/x-script.elisp
auto_view text/x-lisp
auto_view text/x-diff
auto_view text/x-patch
bind generic l select-entry
bind attach <enter> view-mailcap
bind attach <return> view-mailcap
bind attach u exit
bind attach h exit
bind  attach         H display-toggle-weed
bind  compose        l view-attach
bind attach,browser,index,generic  G last-entry
bind attach,browser,index,generic gg first-entry
bind attach,browser,index,pager \CB previous-page
bind attach,browser,index,pager \CF next-page
bind attach,browser,pager,index,generic \Cd half-down
bind attach,browser,pager,index,generic \Cu half-up
bind attach,index L bottom-page         # Normally <list-reply>.
bind browser S unsubscribe
bind browser,pager,generic \Ce next-line
bind browser,pager,generic \Cy previous-line
bind browser,pager,index  N search-opposite
bind compose p postpone-message
bind editor <Tab> complete-query
bind editor ^T    complete
bind editor <backspace> backspace
bind editor <delete> delete-char
bind editor \CT complete
bind editor \Cn history-down
bind editor \Cp history-up
set history=25
bind generic x tag-entry
bind generic zb current-bottom
bind generic zt current-top
bind generic zz current-middle
bind index ,\t previous-unread
bind index <Backtab> previous-new-then-unread
bind index <space>  collapse-thread
bind index <tab>    sync-mailbox
bind index <tab> next-unread
bind index D delete-message
bind index F search
bind index U undelete-message
bind index \Ce next-line
bind index \Cy previous-line
bind index \t next-unread
bind index p recall-message
bind index x tag-entry
bind index zA  collapse-all # Missing :folddisable/foldenable
bind index za  collapse-thread
bind index - collapse-thread
bind index _ collapse-all
# bind index,pager <F3> sidebar-page-up
# bind index,pager <F4> sidebar-page-down
# bind index,pager <F5> sidebar-prev-new
bind index,pager <down>   sidebar-next
bind index,pager <right>  sidebar-open
bind index,pager <up>     sidebar-prev
bind index,pager @ compose-to-sender
# bind index,pager B sidebar-toggle-visible
bind index,pager F flag-message
bind index,pager O edit
bind index,pager P parent-message
bind index,pager \Cn sidebar-next
bind index,pager \Co sidebar-open
bind index,pager \Cp sidebar-prev
bind index,pager \ey edit-label
bind pager ,\t previous-unread
bind pager <down> next-line
bind pager <up> previous-line  # scroll inside the message rather than the index
bind pager G bottom
bind index,pager R group-reply
bind pager \t next-unread
bind pager gg top
bind pager j next-line
bind pager k previous-line     # scroll inside the message rather than the index
bind pager l view-attachments
bind  attach,compose l view-attach
bind pager u exit
bind pager x tag-message
bind pager,index dT delete-thread
bind pager,index dd delete-message
bind pager,index dt delete-subthread
bind pager,index gT previous-thread
bind pager,index gt next-thread
charset-hook ^iso-8859-1$ cp1252
# folder-hook . "push <collapse-all>\n"
folder-hook . 'set read_inc=1000'
ignore *                                # ignore all headers
ignore Content-Transfer-Encoding:
ignore Content-Type:
ignore User-Agent
macro attach,compose \cu "<pipe-entry> urlscan -cd<Enter>" 
# macro index C "<copy-message>?<toggle-mailboxes>" "copy a message to a mailbox"macro index c "<change-folder>?" "change folder"
macro index h '<change-folder>?'
macro index S "<shell-escape>offlineimap<enter>"
macro index gd "<change-folder>=Drafts<enter>" "Go to drafts"
macro index gi "<change-folder>=INBOX<enter>"  "Go to inbox"
macro index c "<change-folder>?<toggle-mailboxes>" "open a different folder"
macro pager c "<change-folder>?<toggle-mailboxes>" "open a different folder"
# mailboxes `find -H ~/Mail -mindepth 0 -maxdepth 3 -type d \! -name "Spam" -printf "+'%f' "`
mailboxes `find ~/Mail '(' -type d '(' -name 'cur' -o -name 'new' ')' -prune -printf '%h ' ')' -o '(' -type f -printf '%p ' ')' | sed 's: /:\n/:g' | sed '/^$/d' | sort | uniq | tr '\n' ' '`
# macro index gj "<change-folder>=Junk<enter>"   "Go to junk"
# macro index gs "<change-folder>=Sent<enter>"   "Go to sent"
macro index gt "<change-folder>=Trash<enter>"  "Go to trash"
macro index M "<tag-thread><tag-prefix><save-message>?/" "move thread to mailbox"
# macro index p "<display-toggle-weed> <print-message> <display-toggle-weed> <exit>"
bind  index,pager    H display-toggle-weed
macro index s "<shell-escape>offlineimap -qf INBOX<enter>"
macro index,pager  a "<pipe-message>abook --add-email-quiet<return>" "Add this sender to Abook"
macro index,pager H view-mailcap
bind  pager          h exit
macro index,pager V "<view-attachments><search>html<enter><view-mailcap><exit>"
macro index,pager \cu "<pipe-message> urlscan<Enter>" "call urlscan to extract URLs out of a message"
message-hook .  'macro index,pager \cb ,b "URL viewer"'
message-hook ~G 'macro index,pager \cb ,B "URL viewer"'
set abort_nosubject  = ask-yes
set abort_noattach = ask-yes
set attach_keyword = "\\<attach(|ed|ments?)\\>"
set abort_unmodified = ask-yes
set alias_format="%4n %2f %t %-12a  %r"
set hdr_format="%3C %Z %[!%m/%d/%y] (%4l) %-22.22F %s"
set allow_ansi
set ascii_chars=yes
set ask_follow_up     = no
set ask_x_comment_to  = no
set assumed_charset   = "utf-8"
set attach_format     = '%u%D%I %t%4n %T%.40d%> [%.12m/%.12M, %.6e%?C?, %C?, %s]
set attach_keyword    = "\\<attach(|ed|ments?)\\>"
set attribution       ='On %{%a, %d %b %Y}, %n wrote:\n'
set auto_tag          = yes
set autoedit
set beep_new                     # don't beep on new message
set bounce            = yes
set bounce_delivered=no
set catchup_newsgroup = ask-yes
set charset           = "utf-8"
set check_new = yes
set compose_format="-- %v-- Compose  [Approximate Message Size: %l   Attachments: %a]%>-"
set config_charset    = "utf-8"
set copy                         # save copies of sent messages
set date_format       ="%d/%m/%y %I:%M"
set delete                       # don't ask me to delete messages - just do it!
set delete_untag                 # untag messages when marking them for deletion
set editor         = "nvim +/^$ ++1 -c start"       # start editor in insert mode
set envelope_from                # which from?
set fast_reply                   # don't prompt for stuff when replying
set fcc_attach                   # save attachments with the body
set fcc_clear
set folder = "~/Mail"
set folder_format="%3C %t%N %F %-8.8u %-8.8g %8s %d %f"
set followup_to                  # add Mail-Followup-To header
set followup_to_poster = ask-yes
set forward_decode               # decode when forwarding
set forward_edit   = ask-yes     # automatically start editor when forwarding.
set forward_format = "Fwd: %s"   # format of subject when forwarding
set forward_quote                # include message in forwards
set from = "kg314@ic.ac.uk"
set group_index_format = '%4C %M%N %5s  %-45.45f %d'
set help                      # show help on first line of display
set hidden_host
set honor_followup_to=ask-yes # Ask whether to honor Mail-Followup-To header.
set hostname = "ic.ac.uk"     # who am i?
set implicit_autoview="yes" # Autoview every MIME type with a copiousoutput entry in mailcap.
set include                   # include message in replies
set indent_str   = "> "
# set index_format = "%2C %Z %d %-15.15F %s (%-4.4c)"
#
#
## We replace the date field '%{%b %d}', giving:
set index_format='%4C %Z %<[y?%<[m?%<[d?%[%H:%M ]&%[%a %d]>&%[%b %d]>&%[%m/%y ]> %-15.15L (%?l?%4l&%4c?) %s'
## Test  Date Range  Format String  Example
## --------------------------------------------
## %[d   Today       %[%H:%M ]      12:34
## %[m   This month  %[%a %d]       Thu 12
## %[y   This year   %[%b %d]       Dec 10
## -     Older       %[%m/%y ]      06/15
set inews        = ''
# set locale       = `echo "${LC_ALL:-${LC_TIME:-${LANG}}}"`
bind index <esc>L limit-current-thread
set mailcap_path = ~/dotfiles/email_stuff/.mutt/mailcap
set mask = no
set mbox_type=Maildir
set message_format="%-.16n: %s"
set metoo=no
set mime_forward          = no # forward all attachments as a single attachment?
set mime_forward_rest     = "yes"
mime_lookup       application/octet-stream
mime_lookup text/plain		 	# See if it is really the correct MIME type, otherwise change it.
set mime_subject          = yes
set my_sent_noquote       = "Sent Items"
set my_tprot              = 't-prot -aelmtS -c --bigq -M=mutt --spass'
# set narrow_tree # narrow threading trees
set net_inc               = "100"
set new_mail_command      = "notify-send 'New Email in %f' '%n new messages, %u unread.' &"
set news_cache_dir        = '~/.neemail_stuff/.mutt'
set news_server           = 'news.in-berlin.de'
set newsgroups_charset    = utf-8
set newsrc                = '~/.newsrc'
set nntp_authenticators   = ''
set nntp_context          = 200
set nntp_listgroup        = yes
set nntp_load_description = yes
set nntp_pass             = ''
set nntp_poll             = 60
set nntp_user             = ''
set nosave_empty
set noprompt_after
set pager_context         = 4
set pager_format          = "~~~~~~~~~ On %{%a, %d %b %Y} at [%[%H:%M]]: %s %|~"
set pager_index_lines     = 10 # add small message index at top of pager (5)
set pager_stop            = yes      # don't go to next message at end of message
set pipe_decode  # strip headers and eval mimes when piping
set post_moderated        = ask-yes
# set postpone              = ask-no
set postponed             = "=INBOX.Drafts"
set print                 = ask-yes
# set print_command="/usr/bin/muttprint %s -p {PrinterName}"
set print_command="muttprint"
set prompt_after          = no
set query_command         = "abook --mutt-query '%s'"
# set query_command         = "mates --mutt-query '%s'"
set quote_regexp          = "^( {0,4}[>|:#%]| {0,4}[a-z0-9]+[>|]+)+"
set realname              = "Krishnakumar"  
set recall                = ask-yes
set record                = +$my_sent_noquote
set reply_regexp          = "^(([Rr][Ee]?(\[[0-9]+\])?: *)?(\[[^]]+\] *)?)*"
set reply_to                                  # reply to Reply to: field
set reverse_alias         = yes
set reverse_name                              # reply as whomever it was to
set reverse_realname      = yes
set rfc2047_parameters    = yes               # encode = ?iso-8858....? = filenames
set save_unsubscribed     = no
set send_charset          = "us-ascii:utf-8"
set sendmail              = "~/dotfiles/email_stuff/.mutt/krishna_sendmail"
set sendmail_wait         = -1                 
set shell                 = /bin/bash
set show_new_news         = yes
set show_only_unread      = no
set sidebar_delim_chars   = '/'
set sidebar_divider_char  = ' ▐ '
set sidebar_folder_indent = yes
set sidebar_indent_string = '  '
# set sidebar_new_mail_only = yes
set sidebar_next_new_wrap = yes
set sidebar_on_right      = no
set sidebar_short_path    = yes
set sidebar_component_depth=1
set sidebar_sort_method   = 'path'
set sidebar_visible       = yes
set sidebar_format        =  "%B%?F? [%F]?%* %?N?%N/?%S"
set sidebar_width         = 30
set mail_check_stats = yes
set sig_dashes=no   # no dashes between message text and signature
set sig_on_top                     # puts signature above quoted or forwarded text
set skip_quoted_offset = 3
set sleep_time = 0                 # be fast
set smart_wrap                     # wrap long lines at word boundary.
set sort             = reverse-threads
set sort_alias = alias
set sort_aux         = date-received
set sort_browser     = alpha       # is the default I think, but anyway
set sort_re                        # thread based on regex
set noallow_8bit
# set sort  = threads
# set sort_aux = 'reverse-last-date-received'
# set sort_browser="reverse-count"
set spoolfile        = "+INBOX"
set status_chars     = " *%A"
set status_format    = "%f%?V?/%V? [%m%?M?, %M shown?%?n?, %n new?%?o?, %o old?%?d?, %d deleted?%?F?, %F flagged?%?t?, %t tagged?%?p?, %p postponed?] %> %P"
set status_on_top
set strict_threads   = yes
set text_flowed      = yes  # send format-flowed; vim must be set to fo+ = w
set reflow_text
set reflow_space_quotes
set thorough_search  # strip headers and eval mimes before searching
set tilde            = yes
set timeout          = "5"
set tmpdir = '/tmp/mutt'
set to_chars         = "X+TCF" # no L for mail_list
set ts_enabled       = yes
set ts_status_format = 'mutt %m messages%?n?, %n new?'
# set uncollapse_jump  # jump to unread message when uncollapse
set visual       = "nvim"
set x_comment_to = no
set xterm_set_titles
unignore From To Cc Subject Date Reply-To Organization X-Mailer User-Agent
unignore Newsgroups:
# unset arrow_cursor    # use arrow cursor
unset askbcc          # don't prompt for bcc's
unset askcc           # don't prompt for cc's
unset beep            # don't beep on error
unset collapse_unread # don't collapse threads with unread mails
unset confirmappend   # may want to change this later
unset ignore_list_reply_to
unset mark_old        # don't mark unread messages as Old
unset markers         # put a '+' at the beginning of wrapped lines.
set menu_scroll     # scroll menu a page on last line
set menu_context=5			# Lines of context
unset menu_move_off			# Don't let last items of menus scroll up past the bottom of the screen.
unset mime_forward    # forward attachments as part of body
unset move
unset reply_self
unset use_domain
set use_from
unset user_agent
unset wait_key        # don't wait for keystroke to return from shell

# set display_filter="t-prot -cemt -M=mutt"
set display_filter = $my_tprot

# my_hdr Organization: Imperial College London
# my_hdr X-Operating-System: `uname -s`, kernel `uname -r`
unhdr_order *         # some distros order things by default
hdr_order from: to: cc: date: subject:  # and in this order

# Handler for gzip compressed mailboxes
open-hook   '\.gz$' "gzip --stdout --decompress '%f' >  '%t'"
close-hook  '\.gz$' "gzip --stdout              '%t' >  '%f'"
append-hook '\.gz$' "gzip --stdout              '%t' >> '%f'"
# Handler for bzip2 compressed mailboxes
open-hook   '\.bz2$' "bzip2 --stdout --decompress '%f' >  '%t'"
close-hook  '\.bz2$' "bzip2 --stdout              '%t' >  '%f'"
append-hook '\.bz2$' "bzip2 --stdout              '%t' >> '%f'"
# Handler for xz compressed mailboxes
open-hook   '\.xz$' "xz --stdout --decompress '%f' >  '%t'"
close-hook  '\.xz$' "xz --stdout              '%t' >  '%f'"
append-hook '\.xz$' "xz --stdout              '%t' >> '%f'"
# Handler for pgp encrypted mailboxes
# PGP does not support appending to an encrypted file
open-hook   '\.pgp$' "pgp -f < '%f' > '%t'"
close-hook  '\.pgp$' "pgp -fe YourPgpUserIdOrKeyId < '%t' > '%f'"
# Handler for gpg encrypted mailboxes
# gpg does not support appending to an encrypted file
open-hook   '\.gpg$' "gpg --decrypt < '%f' > '%t'"
close-hook  '\.gpg$' "gpg --encrypt --recipient YourGpgUserIdOrKeyId < '%t' > '%f'"
push <show-version>
# After $timeout seconds of inactivity, run this NeoMutt command
timeout-hook 'exec sync-mailbox'
# When NeoMutt first loads, run this NeoMutt command
startup-hook 'exec sync-mailbox'
# When NeoMutt quits, run this NeoMutt command
shutdown-hook 'exec sync-mailbox'


# macro index,pager A \
#     "<pipe-message>abook add | xargs abook edit<enter>" \
#     "add the sender address"

# source ~/dotfiles/email_stuff/.mutt/colors_dir/sven_guckes
# source ~/dotfiles/email_stuff/.mutt/colors_dir/theme256
# source ~/dotfiles/email_stuff/.mutt/colors_dir/krishna_custom_neomutt_colors
source ~/dotfiles/email_stuff/.mutt/colors_dir/atomic
# source ~/dotfiles/email_stuff/.mutt/colors_dir/colors256-light
# source ~/dotfiles/email_stuff/.mutt/colors_dir/gruvbox
# source ~/dotfiles/email_stuff/.mutt/colors_dir/jellyjam
# source ~/dotfiles/email_stuff/.mutt/colors_dir/konsole-color
# source ~/dotfiles/email_stuff/.mutt/colors_dir/monster_island
# source ~/dotfiles/email_stuff/.mutt/colors_dir/neonwolf-256.muttrc
# source ~/dotfiles/email_stuff/.mutt/colors_dir/sol_dark
# source ~/dotfiles/email_stuff/.mutt/colors_dir/zenburn

# color body brightmagenta black "^\\[---.*"
# color body green	 black "^#v[-+]"
# color body brightgreen   black "^[+].*"
# color body brightred     black "^-.*"
# color body brightwhite   black "^diff --git.*"
# color body brightwhite   black "^index [a-f0-9].*"
# color body brightyellow  black "^@@.*"
# color sidebar_new yellow default
# color body red default "([a-z][a-z0-9+-]*://(((([a-z0-9_.!~*'();:&=+$,-]|%[0-9a-f][0-9a-f])*@)?((([a-z0-9]([a-z0-9-]*[a-z0-9])?)\\.)*([a-z]([a-z0-9-]*[a-z0-9])?)\\.?|[0-9]+\\.[0-9]+\\.[0-9]+\\.[0-9]+)(:[0-9]+)?)|([a-z0-9_.!~*'()$,;:@&=+-]|%[0-9a-f][0-9a-f])+)(/([a-z0-9_.!~*'():@&=+$,-]|%[0-9a-f][0-9a-f])*(;([a-z0-9_.!~*'():@&=+$,-]|%[0-9a-f][0-9a-f])*)*(/([a-z0-9_.!~*'():@&=+$,-]|%[0-9a-f][0-9a-f])*(;([a-z0-9_.!~*'():@&=+$,-]|%[0-9a-f][0-9a-f])*)*)*)?(\\?([a-z0-9_.!~*'();/?:@&=+$,-]|%[0-9a-f][0-9a-f])*)?(#([a-z0-9_.!~*'();/?:@&=+$,-]|%[0-9a-f][0-9a-f])*)?|(www|ftp)\\.(([a-z0-9]([a-z0-9-]*[a-z0-9])?)\\.)*([a-z]([a-z0-9-]*[a-z0-9])?)\\.?(:[0-9]+)?(/([-a-z0-9_.!~*'():@&=+$,]|%[0-9a-f][0-9a-f])*(;([-a-z0-9_.!~*'():@&=+$,]|%[0-9a-f][0-9a-f])*)*(/([-a-z0-9_.!~*'():@&=+$,]|%[0-9a-f][0-9a-f])*(;([-a-z0-9_.!~*'():@&=+$,]|%[0-9a-f][0-9a-f])*)*)*)?(\\?([-a-z0-9_.!~*'();/?:@&=+$,]|%[0-9a-f][0-9a-f])*)?(#([-a-z0-9_.!~*'();/?:@&=+$,]|%[0-9a-f][0-9a-f])*)?)[^].,:;!)? \t\r\n<>\"]"